# ğŸ“ After School Club â€“ Backend (Node.js + Express + MongoDB)

This repository contains the **backend API** for the After School Club full-stack application.  
It provides REST endpoints for managing lessons and handling student orders.

The backend is built with **Node.js**, **Express**, and **MongoDB Atlas** and deployed using **Render**.

---

## ğŸŒ Live Backend API (Render)

**Base URL:**  
https://after-school-backend-ri4h.onrender.com

---

## ğŸ§© Tech Stack

- **Node.js**
- **Express.js**
- **MongoDB Atlas** (Cloud NoSQL Database)
- **Native MongoDB Driver** (no Mongoose)
- **CORS + JSON middleware**
- **Render.com** cloud hosting

---

## ğŸ“¦ Project Structure

```
backend/
â”‚
â”œâ”€â”€ data.js                 # Seed lesson data
â”œâ”€â”€ server.js               # Main server file (Express + MongoDB)
â”œâ”€â”€ .env                    # Environment variables (not committed)
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

---

## ğŸ”§ Environment Variables

Your `.env` file must include:

```
MONGO_URI=mongodb+srv://<your-connection-string>
DB_NAME=afterSchoolDB
PORT=4000
```

These values are **also configured inside Render** for deployment.

---

## ğŸš€ API Endpoints

### âœ… Health Check
**GET /**  
Returns:
```json
"Backend running âœ…"
```

---

## ğŸ“š Lessons Endpoints

### **GET /api/courses**
Fetch all lessons.  
Supports **search + sorting**.

Example request:
```
GET /api/courses?q=math&sortField=price&sortOrder=asc
```

Response:
```json
{
  "courses": [
    {
      "id": 1,
      "title": "Math Club",
      "price": 10,
      "spaces": 5,
      "location": "London",
      ...
    }
  ]
}
```

---

### **POST /api/courses/import**
Imports seed lessons from `data.js` into MongoDB.  
Used once during setup.

Response:
```json
{
  "message": "Lessons imported",
  "count": 10
}
```

---

## ğŸ›’ Orders Endpoints

### **POST /api/orders**
Creates a new order and reduces lesson spaces.

Example request:
```json
{
  "name": "Alex",
  "phone": "07123456789",
  "total": 20,
  "items": [
    { "id": 1, "title": "Math Club", "quantity": 2, "price": 10 }
  ]
}
```

Response:
```json
{
  "message": "Order saved successfully",
  "order": {
    "_id": "...",
    "name": "Alex",
    "phone": "07123456789",
    "items": [...],
    "total": 20
  }
}
```

---

### **GET /api/orders**
Returns all placed orders, newest first.

Response:
```json
{
  "orders": [
    {
      "name": "Alex",
      "phone": "07123456789",
      "total": 20,
      "createdAt": "2024-12-01T10:00:00Z",
      "items": [...]
    }
  ]
}
```

---

## ğŸ›  How to Run Backend Locally

### 1ï¸âƒ£ Install dependencies
```
npm install
```

### 2ï¸âƒ£ Add `.env` file (if missing)
```
MONGO_URI=your-atlas-connection-string
DB_NAME=afterSchoolDB
PORT=4000
```

### 3ï¸âƒ£ Start server
```
node server.js
```

Backend runs on:
```
http://localhost:4000
```

---

## â˜ï¸ Deployment (Render)

This backend is deployed on **Render.com**, using:

- **Build Command:** `npm install`
- **Start Command:** `node server.js`
- **Environment Variables:** MONGO_URI, DB_NAME, PORT

Render automatically restarts the server when new commits are pushed.

---

## ğŸ§‘â€ğŸ’» Author

**Yug Patel**  
BSc (Hons) Computer Science â€“ Middlesex University London

---

## ğŸ“„ Notes

- This backend powers the Vue.js frontend for the After School Club project.
- Includes search, sorting, checkout, and live lesson availability updates.
- Designed to meet CST3144 full-stack coursework requirements.